<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=iso-8859-1">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 9">
<meta name=Originator content="Microsoft Word 9">
<link rel=File-List href="./TreeParameter_files/filelist.xml">
<link rel=Edit-Time-Data href="./TreeParameter_files/editdata.mso">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]-->
<title>TreeParameter &amp; TreeVariable classes</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>fox</o:Author>
  <o:LastAuthor>fox</o:LastAuthor>
  <o:Revision>3</o:Revision>
  <o:TotalTime>22</o:TotalTime>
  <o:Created>2004-04-06T14:46:00Z</o:Created>
  <o:LastSaved>2005-04-18T13:02:00Z</o:LastSaved>
  <o:Pages>13</o:Pages>
  <o:Words>4660</o:Words>
  <o:Characters>26567</o:Characters>
  <o:Company>MSU</o:Company>
  <o:Lines>221</o:Lines>
  <o:Paragraphs>53</o:Paragraphs>
  <o:CharactersWithSpaces>32626</o:CharactersWithSpaces>
  <o:Version>9.6926</o:Version>
 </o:DocumentProperties>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
@font-face
	{font-family:Times;
	panose-1:2 2 6 3 5 4 5 2 3 4;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:Courier;
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:modern;
	mso-font-format:other;
	mso-font-pitch:fixed;
	mso-font-signature:3 0 0 0 1 0;}
@font-face
	{font-family:"Trebuchet MS";
	panose-1:2 11 6 3 2 2 2 2 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:7 0 0 0 19 0;}
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:Times;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";}
p.MsoBodyText2, li.MsoBodyText2, div.MsoBodyText2
	{margin:0in;
	margin-bottom:.0001pt;
	text-align:justify;
	text-indent:15.0pt;
	line-height:15.0pt;
	mso-pagination:widow-orphan;
	font-size:14.0pt;
	font-family:Times;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{color:blue;
	text-decoration:underline;
	text-underline:single;}
p
	{margin-right:0in;
	mso-margin-top-alt:auto;
	mso-margin-bottom-alt:auto;
	margin-left:0in;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.code, li.code, div.code
	{mso-style-name:code;
	margin:0in;
	margin-bottom:.0001pt;
	line-height:18.75pt;
	mso-pagination:widow-orphan;
	font-size:14.0pt;
	font-family:Courier;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	color:#0000CC;}
p.head1, li.head1, div.head1
	{mso-style-name:head1;
	margin-right:0in;
	mso-margin-top-alt:auto;
	mso-margin-bottom-alt:auto;
	margin-left:0in;
	line-height:15.0pt;
	mso-pagination:widow-orphan;
	font-size:13.5pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	font-weight:bold;}
p.head2, li.head2, div.head2
	{mso-style-name:head2;
	margin-right:0in;
	mso-margin-top-alt:auto;
	mso-margin-bottom-alt:auto;
	margin-left:0in;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	font-weight:bold;}
span.code1
	{mso-style-name:code1;
	mso-ansi-font-size:14.0pt;
	mso-bidi-font-size:14.0pt;
	mso-ascii-font-family:Courier;
	mso-hansi-font-family:Courier;
	color:#0000CC;
	letter-spacing:18.75pt;
	mso-font-width:1%;}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
-->
</style>
</head>

<body lang=EN-US link=blue vlink=blue style='tab-interval:.5in'>

<div class=Section1>

<h1 align=center style='text-align:center'>TreeParameter and TreeVariable
classes for SpecTcl 2.1</h1>

<p align=center style='text-align:center'>D. Bazin, Ron Fox</p>

<p align=center style='text-align:center'>National Superconducting Cyclotron
Laboratory</p>

<p align=center style='text-align:center'>Michigan State University</p>

<p align=center style='text-align:center'>East Lansing, MI 48823, USA</p>

<p align=center style='text-align:center'>Abstract</p>

<p><em>The TreeParameter and TreeVariable classes have been modified to take advantage
of the new features present in SpecTcl 2.1, in particular the use of real
valued parameters and arbitrary binning of spectra. The new version of these
classes (1.2) is backward compatible with code previously written for earlier
versions of SpecTcl. The Graphical User Interface (GUI) associated with these
classes has been updated and improved.</em></p>

<p class=head1 align=center style='text-align:center'><em>Contents</em></p>

<p class=MsoNormal style='margin-left:.5in;text-indent:-.5in;line-height:15.0pt'><em><b><span
style='font-size:13.5pt;font-family:"Times New Roman"'><a href="#I.">Presentation</a></span></b></em><b><span
style='font-size:13.5pt;font-family:"Times New Roman"'><o:p></o:p></span></b></p>

<p class=MsoNormal style='margin-left:.5in;text-indent:-.5in;line-height:15.0pt'><em><b><span
style='font-size:13.5pt;font-family:"Times New Roman"'><a href="#II.">Changes</a></span></b></em><b><span
style='font-size:13.5pt;font-family:"Times New Roman"'><o:p></o:p></span></b></p>

<p class=MsoNormal style='margin-left:.5in;text-indent:-.5in;line-height:15.0pt'><em><b><span
style='font-size:13.5pt;font-family:"Times New Roman"'><a href="#III.">Constructors
and initialization</a></span></b></em><b><span style='font-size:13.5pt;
font-family:"Times New Roman"'> <o:p></o:p></span></b></p>

<p class=MsoNormal style='margin-left:1.0in;text-indent:-1.0in;line-height:
15.0pt'><em><b><span style='font-family:"Times New Roman"'><a href="#III.a.">CTreeParameter
class</a></span></b></em><b><span style='font-family:"Times New Roman"'><o:p></o:p></span></b></p>

<p class=MsoNormal style='margin-left:1.0in;text-indent:-1.0in;line-height:
15.0pt'><em><b><span style='font-family:"Times New Roman"'><a href="#III.b.">CTreeParameterArray
class</a></span></b></em><b><span style='font-family:"Times New Roman"'><o:p></o:p></span></b></p>

<p class=MsoNormal style='margin-left:1.0in;text-indent:-1.0in;line-height:
15.0pt'><em><b><span style='font-family:"Times New Roman"'><a href="#III.c.">CTreeVariable
class</a></span></b></em><b><span style='font-family:"Times New Roman"'><o:p></o:p></span></b></p>

<p class=MsoNormal style='margin-left:1.0in;text-indent:-1.0in;line-height:
15.0pt'><em><b><span style='font-family:"Times New Roman"'><a href="#III.d.">CTreeVariableArray
class</a></span></b></em><b><span style='font-family:"Times New Roman"'><o:p></o:p></span></b></p>

<p class=MsoNormal style='margin-left:.5in;text-indent:-.5in;line-height:15.0pt'><b><span
style='font-size:13.5pt;font-family:"Times New Roman"'><a href="#IV."><em>Usage</em></a>
<o:p></o:p></span></b></p>

<p class=MsoNormal style='margin-left:1.0in;text-indent:-1.0in;line-height:
15.0pt'><b><span style='font-family:"Times New Roman"'><a href="#IV.a."><em>Defining
the tree using classic structures</em></a><o:p></o:p></span></b></p>

<p class=MsoNormal style='margin-left:1.0in;text-indent:-1.0in;line-height:
15.0pt'><b><span style='font-family:"Times New Roman"'><a href="#IV.b."><em>Defining
the tree using C++ classes</em></a><o:p></o:p></span></b></p>

<p class=MsoNormal style='margin-left:1.0in;text-indent:-1.0in;line-height:
15.0pt'><b><span style='font-family:"Times New Roman"'><a href="#IV.c."><em>Handling
of array of classes</em></a><o:p></o:p></span></b></p>

<p class=MsoNormal style='margin-left:.5in;text-indent:-.5in;line-height:15.0pt'><b><span
style='font-size:13.5pt;font-family:"Times New Roman"'><a href="#V."><em>Implementation</em></a>
<o:p></o:p></span></b></p>

<p class=MsoNormal style='margin-left:1.0in;text-indent:-1.0in;line-height:
15.0pt'><b><span style='font-family:"Times New Roman"'><a href="#V.a."><em>Include
files</em></a><o:p></o:p></span></b></p>

<p class=MsoNormal style='margin-left:1.0in;text-indent:-1.0in;line-height:
15.0pt'><b><span style='font-family:"Times New Roman"'><a href="#V.b."><em>Additions
to the main program</em></a><o:p></o:p></span></b></p>

<p class=MsoNormal style='margin-left:1.0in;text-indent:-1.0in;line-height:
15.0pt'><b><span style='font-family:"Times New Roman"'><a href="#V.c."><em>Additions
to the first event processor</em></a><o:p></o:p></span></b></p>

<p class=MsoNormal style='margin-left:.5in;text-indent:-.5in;line-height:15.0pt'><b><span
style='font-size:13.5pt;font-family:"Times New Roman"'><a href="#VI."><em>GUI
features</em></a> <o:p></o:p></span></b></p>

<p class=MsoNormal style='margin-left:1.0in;text-indent:-1.0in;line-height:
15.0pt'><b><span style='font-family:"Times New Roman"'><a href="#VI.a."><em>Spectra
manipulation page</em></a><o:p></o:p></span></b></p>

<p class=MsoNormal style='margin-left:1.0in;text-indent:-1.0in;line-height:
15.0pt'><b><span style='font-family:"Times New Roman"'><a href="#VI.b."><em>Parameter
manipulation page</em></a><o:p></o:p></span></b></p>

<p class=MsoNormal style='margin-left:1.0in;text-indent:-1.0in;line-height:
15.0pt'><b><span style='font-family:"Times New Roman"'><a href="#VI.c."><em>Variable
manipulation page</em></a><o:p></o:p></span></b></p>

<p class=MsoNormal style='margin-left:1.0in;text-indent:-1.0in;line-height:
15.0pt'><b><span style='font-family:"Times New Roman"'><a href="#VI.d."><em>Gate
manipulation page</em></a><o:p></o:p></span></b></p>

<p class=MsoNormal style='margin-left:.5in;text-indent:-.5in;line-height:15.0pt'><b><span
style='font-size:13.5pt;font-family:"Times New Roman"'><a href="#VII."><em>Future
improvements</em></a> <o:p></o:p></span></b></p>

<p class=MsoNormal style='margin-left:1.0in;text-indent:-1.0in;line-height:
15.0pt'><b><span style='font-family:"Times New Roman"'><a href="#VII.a."><em>Filtering
GUI</em></a><o:p></o:p></span></b></p>

<p class=MsoNormal style='margin-left:1.0in;text-indent:-1.0in;line-height:
15.0pt'><b><span style='font-family:"Times New Roman"'><a href="#VII.b."><em>Validity
of parameters</em></a><o:p></o:p></span></b></p>

<p class=MsoNormal style='margin-left:1.0in;text-indent:-1.0in;line-height:
15.0pt'><b><span style='font-family:"Times New Roman"'><a href="#VII.c."><em>Saving
histograms to disk</em></a><o:p></o:p></span></b></p>

<p class=MsoNormal style='margin-left:1.0in;text-indent:-1.0in;line-height:
15.0pt'><b><span style='font-family:"Times New Roman"'><a href="#VII.d."><em>Preserve
gate condition when rescaling spectra </em></a><o:p></o:p></span></b></p>

<h1><a name=I. id=I.>I. Presentation</a></h1>

<p class=MsoBodyText2>The TreeParameter class provides a mean to implement
parameters in SpecTcl in a tree-like structure and without the need to specify
parameter ids. The parameters are referred to by their names only, which at the
same time indicate their location in the tree. This reference mechanism is
valid for both the coding part of SpecTcl (C++ code) and the interpreter part
(Tcl/Tk shell). It eliminates the confusion induced by the use of numerals to
refer to the parameters, and allows the user to organize the parameters in a
logical fashion.</p>

<p class=MsoBodyText2>Most detector ensembles or complex devices can be easily
represented by a tree-like structure. The top (or root depending on the growth
direction) of the tree is usually the name of the device itself. Then each
component of the device can be represented as branches of the tree containing
themselves other branches and so on. The immediate advantage of this technique
is that the name of any part of the tree is meaningful and shows its location
in the tree. An example of an excerpt of such a tree is shown in the figure
below.</p>

<p align=center style='text-align:center'><img border=0 width=616 height=358
id=Figure1 src="TreeParameter_files\image001.jpg" name=Figure1></p>

<p class=MsoBodyText2>In this example the TreeParameter s800.fp.ic.de.02
represents the second channel of the energy loss measurement from the ion chamber
detector located in the focal plane of the S800 Spectrograph. In the C++ code
of SpecTcl, this parameter name can be used directly on either side of any
assignment.</p>

<p class=MsoBodyText2>The TreeVariable class is built on the same principles as
the TreeParameter class. TreeVariables are also organized in a tree-like
structure that can be either separate from or embedded in a structure already
containing TreeParameters. This proximity is very useful to keep track of
variables associated with parameters, as they bear similar locations in the
tree and are readily available when using C++ classes to build the tree. They
are typically used for calibrations, pedestals, switches or any purpose
requiring the possibility to vary a value dynamically in SpecTcl. Each C++
TreeVariable is linked to a Tcl variable with the same name. The user has then
full flexibility to either read or set the C++ TreeVariable from the Tcl/Tk
shell using the set Tcl command.<o:p></o:p></p>

<h1><a name=II. id=II.>II. Changes</a></h1>

<p class=MsoBodyText2>In previous versions of SpecTcl, parameters could only
accept integer values that were directly mapped to the binning of the spectra
where they were histogrammed. Although this approach is acceptable when
histogramming data directly coming from Analog-to-Digital converters, it
quickly breaks down as soon as results from calculations need to be visualized
in a spectrum. The &#8220;old&#8221; way of dealing with this issue was to map a range of
the calculated value on the integer parameter using a set of coefficients. This
mechanism was provided by the old version of the TreeParameter class, in which
the user had the possibility to specify this range in the C++ code and could
also dynamically alter it from the Tcl shell. However, a major shortcoming was
that the mapping was not passed on to the displayer Xamine, which continued to
show useless bins instead of the corresponding real values of the parameter.</p>

<p class=MsoBodyText2>In SpecTcl 2.1 the arbitrary binning that was implemented
in the TreeParameter class has been taken over by SpecTcl itself when using
real valued parameters. The binning is then defined for each spectrum by
specifying a lower and a higher limit, as well as a number of bins. This
approach is much more flexible as it allows the definition of different spectra
histogramming the same parameter but with a different binning and/or range.
Xamine has now the capability of displaying the spectra as a function of the
real values of the parameters by clicking on the &#8220;Map&#8221; button.</p>

<p class=MsoBodyText2>As a result, the internal mapping has been removed from
the TreeParameter class, and the range specification is only used for default
values when building a spectrum. The TreeVariable class hasn&#8217;t changed and is
still restricted to the linking of real values (homogeneous to doubles in C++).</p>

<p class=MsoBodyText2>In SpecTcl 3.0, TreeParameter has been completely
integrated with SpecTcl.<span style="mso-spacerun: yes">&nbsp; </span>As a
result of this integration, much of the code you used to have to add to your
SpecTcl initialization is no longer needed.<span style="mso-spacerun:
yes">&nbsp; </span>Refer to the section <a href="#V.">&#8220;Implementation&#8221;</a> for
more information about this.</p>

<p class=MsoBodyText2><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h1><a name=III. id=III.>III. Constructors and initialization</a></h1>

<p class=MsoBodyText2>The following constructors are provided for defining TreeParameters
and TreeVariables as well as their derived arrays TreeParameterArray and
TreeVariableArray.<o:p></o:p></p>

<h2><a name=III.a. id=III.a.>a. CTreeParameter class</a></h2>

<p class=MsoNormal style='margin-left:.5in;line-height:18.75pt'><span
style='font-size:14.0pt;font-family:Courier;color:#0000CC'>CTreeParameter
(string name, UInt_t bins, double low, double high, string unit)</span><span
style='font-size:14.0pt;font-family:Courier;mso-bidi-font-family:Times;
color:#0000CC'><o:p></o:p></span></p>

<p class=MsoBodyText2>In this constructor all members are spelled out. The <span
class=code1><span style='font-family:Courier;letter-spacing:0pt'>name</span></span>
member should be identical to the path to the location of the object in the
tree, using the dot (.) character to indicate the various branches. The <span
class=code1><span style='font-family:Courier;letter-spacing:0pt'>bins</span></span>,
<span class=code1><span style='font-family:Courier;letter-spacing:0pt'>low</span></span>,
<span class=code1><span style='font-family:Courier;letter-spacing:0pt'>high</span></span>
and <span class=code1><span style='font-family:Courier;letter-spacing:0pt'>unit</span></span>
members are used as default values when defining spectra of this parameter.</p>

<p class=MsoNormal style='margin-left:.5in;line-height:18.75pt'><span
style='font-size:14.0pt;font-family:Courier;color:#0000CC'>CTreeParameter
(string name, double low, double high, string unit)</span><span
style='font-size:14.0pt;font-family:Courier;mso-bidi-font-family:Times;
color:#0000CC'><o:p></o:p></span></p>

<p class=MsoBodyText2>Everything but the number of bins is specified: <span
class=code1><span style='font-family:Courier;letter-spacing:0pt'>bins</span></span>
= 100.</p>

<p class=MsoNormal style='margin-left:.5in;line-height:18.75pt'><span
style='font-size:14.0pt;font-family:Courier;color:#0000CC'>CTreeParameter
(string name, string unit)</span><span style='font-size:14.0pt;font-family:
Courier;mso-bidi-font-family:Times;color:#0000CC'><o:p></o:p></span></p>

<p class=MsoBodyText2>With this constructor the unit is specified, so only the other
members get the default values: <span class=code1><span style='font-family:
Courier;letter-spacing:0pt'>low</span></span> = 1; <span class=code1><span
style='font-family:Courier;letter-spacing:0pt'>high</span></span> = 100; <span
class=code1><span style='font-family:Courier;letter-spacing:0pt'>bins</span></span>
= 100.</p>

<p class=MsoNormal style='margin-left:.5in;line-height:18.75pt'><span
style='font-size:14.0pt;font-family:Courier;color:#0000CC'>CTreeParameter
(string name)</span><span style='font-size:14.0pt;font-family:Courier;
mso-bidi-font-family:Times;color:#0000CC'><o:p></o:p></span></p>

<p class=MsoBodyText2>If only the name of the TreeParameter is specified, the
constructor assigns default values for the remaining members of the class: <span
class=code1><span style='font-family:Courier;letter-spacing:0pt'>low</span></span>
= 1; <span class=code1><span style='font-family:Courier;letter-spacing:0pt'>high</span></span>
= 100; <span class=code1><span style='font-family:Courier;letter-spacing:0pt'>bins</span></span>
= 100; <span class=code1><span style='font-family:Courier;letter-spacing:0pt'>unit</span></span>
= &#8220;unknown&#8221;.</p>

<p class=MsoNormal style='margin-left:.5in;line-height:18.75pt'><span
style='font-size:14.0pt;font-family:Courier;color:#0000CC'>CTreeParameter
(string name, UInt_t bits)</span><span style='font-size:14.0pt;font-family:
Courier;mso-bidi-font-family:Times;color:#0000CC'><o:p></o:p></span></p>

<p class=MsoBodyText2>This constructor is kept for backward compatibility with
previous versions of SpecTcl. The number of bins is equal to 2bits, and the
remaining members are set to the following: <span class=code1><span
style='font-family:Courier;letter-spacing:0pt'>low</span></span> = 0; <span
class=code1><span style='font-family:Courier;letter-spacing:0pt'>high</span></span>
= bins; <span class=code1><span style='font-family:Courier;letter-spacing:0pt'>unit</span></span>
= &#8220;channels&#8221;.</p>

<p class=MsoNormal style='margin-left:.5in;line-height:18.75pt'><span
style='font-size:14.0pt;font-family:Courier;color:#0000CC'>CTreeParameter
(string name, UInt_t bits, double low, double other, string unit, bool choice)</span><span
style='font-size:14.0pt;font-family:Courier;mso-bidi-font-family:Times;
color:#0000CC'><o:p></o:p></span></p>

<p class=MsoBodyText2>Same as previous: this constructor is kept for backward
compatibility. The meaning of the parameter <span class=code1><span
style='font-family:Courier;letter-spacing:0pt'>other</span></span> depends on
value of <span class=code1><span style='font-family:Courier;letter-spacing:
0pt'>choice</span></span>: if <span class=code1><span style='font-family:Courier;
letter-spacing:0pt'>choice</span></span> = false, <span class=code1><span
style='font-family:Courier;letter-spacing:0pt'>other</span></span> is
equivalent to <span class=code1><span style='font-family:Courier;letter-spacing:
0pt'>high</span></span>; if <span class=code1><span style='font-family:Courier;
letter-spacing:0pt'>choice</span></span> = true, <span class=code1><span
style='font-family:Courier;letter-spacing:0pt'>other</span></span> is an
increment (number of &#8220;unit&#8221; per bin).<o:p></o:p></p>

<h2><a name=III.b. id=III.b.>b. CTreeParameterArray class</a></h2>

<p class=MsoNormal style='margin-left:.5in;line-height:18.75pt'><span
style='font-size:14.0pt;font-family:Courier;color:#0000CC'>CTreeParameterArray
(string name, UInt_t bins, double low, double high, string unit, UInt_t size,
UInt_t first)</span><span style='font-size:14.0pt;font-family:Courier;
mso-bidi-font-family:Times;color:#0000CC'><o:p></o:p></span></p>

<p class=MsoBodyText2>The first 6 entries of the full-fledged constructor are
similar to those of the CTreeParameter full-fledged constructor. The two last
entries indicate the number of elements in the array and the index of the first
element. Note that a CTreeParameterArray object is treated in a slightly
different way between the C++ and Tcl worlds. In C++ the array elements are
addressed using the operator [], for instance by writing <span class=code1><span
style='font-family:Courier;letter-spacing:0pt'>somearray[2]</span></span>. In
the Tcl world this element would addressed as <span class=code1><span
style='font-family:Courier;letter-spacing:0pt'>somearray.2</span></span> if
there are less than 10 elements, <span class=code1><span style='font-family:
Courier;letter-spacing:0pt'>somearray.02</span></span> if there are less than
100 elements, and so on.</p>

<p class=MsoNormal style='margin-left:.5in;line-height:18.75pt'><span
style='font-size:14.0pt;font-family:Courier;color:#0000CC'>CTreeParameterArray
(string name, double low, double high, string unit, UInt_t size, UInt_t first)</span><span
style='font-size:14.0pt;font-family:Courier;mso-bidi-font-family:Times;
color:#0000CC'><o:p></o:p></span></p>

<p class=MsoBodyText2>Same as previous constructor but without the number of
bins. The member <span class=code1><span style='font-family:Courier;letter-spacing:
0pt'>bins</span></span> = 100.</p>

<p class=MsoNormal style='margin-left:.5in;line-height:18.75pt'><span
style='font-size:14.0pt;font-family:Courier;color:#0000CC'>CTreeParameterArray
(string name, string unit, UInt_t size, UInt_t first)</span><span
style='font-size:14.0pt;font-family:Courier;mso-bidi-font-family:Times;
color:#0000CC'><o:p></o:p></span></p>

<p class=MsoBodyText2>Same as previous constructor but without the
specification of limits and number of bins. Like its counterpart in
CTreeParameter constructors, <span class=code1><span style='font-family:Courier;
letter-spacing:0pt'>low</span></span> = 1; <span class=code1><span
style='font-family:Courier;letter-spacing:0pt'>high</span></span> = 100; <span
class=code1><span style='font-family:Courier;letter-spacing:0pt'>bins</span></span>
= 100.</p>

<p class=MsoNormal style='margin-left:.5in;line-height:18.75pt'><span
style='font-size:14.0pt;font-family:Courier;color:#0000CC'>CTreeParameterArray
(string name, UInt_t size, UInt_t first)</span><span style='font-size:14.0pt;
font-family:Courier;mso-bidi-font-family:Times;color:#0000CC'><o:p></o:p></span></p>

<p class=MsoBodyText2>Same as previous constructor but with only name
specification: <span class=code1><span style='font-family:Courier;letter-spacing:
0pt'>low</span></span> = 1; <span class=code1><span style='font-family:Courier;
letter-spacing:0pt'>high</span></span> = 100; <span class=code1><span
style='font-family:Courier;letter-spacing:0pt'>bins</span></span> = 100; <span
class=code1><span style='font-family:Courier;letter-spacing:0pt'>unit</span></span>
= &#8220;unknown&#8221;.</p>

<p class=MsoNormal style='margin-left:.5in;line-height:18.75pt'><span
style='font-size:14.0pt;font-family:Courier;color:#0000CC'>CTreeParameterArray
(string name, UInt_t bits, double low, double other, string unit, bool choice,
UInt_t size, UInt_t first)</span><span style='font-size:14.0pt;font-family:
Courier;mso-bidi-font-family:Times;color:#0000CC'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.5in;line-height:18.75pt'><span
style='font-size:14.0pt;font-family:Courier;color:#0000CC'>CTreeParameterArray
(string name, UInt_t bits, UInt_t size, UInt_t first)</span><span
style='font-size:14.0pt;font-family:Courier;mso-bidi-font-family:Times;
color:#0000CC'><o:p></o:p></span></p>

<p class=MsoBodyText2>Again for compatibility issues these two constructors are
maintained and have the same functionality as their CTreeParameter counterparts.<o:p></o:p></p>

<h2><a name=III.c. id=III.c.>c. CTreeVariable class</a></h2>

<p class=MsoNormal style='margin-left:.5in;line-height:18.75pt'><span
style='font-size:14.0pt;font-family:Courier;color:#0000CC'>CTreeVariable
(string name, double value, string unit)</span><span style='font-size:14.0pt;
font-family:Courier;mso-bidi-font-family:Times;color:#0000CC'><o:p></o:p></span></p>

<p class=MsoBodyText2>The CTreeVariable class has only one constructor in which
the name, an initial value and the unit are specified. As for TreeParameters,
the name should be identical to the path to the location of the object in the
tree.<o:p></o:p></p>

<h2><a name=III.d. id=III.d.>d. CTreeVariableArray class</a></h2>

<p class=MsoNormal style='margin-left:.5in;line-height:18.75pt'><span
style='font-size:14.0pt;font-family:Courier;color:#0000CC'>CTreeVariableArray
(string name, double value, string unit, UInt_t size, UInt_t first)</span><span
style='font-size:14.0pt;font-family:Courier;mso-bidi-font-family:Times;
color:#0000CC'><o:p></o:p></span></p>

<p class=MsoBodyText2>Similar to the CTreeParameterArray class the
CTreeVariableArray only constructor requires a number of elements as well as
the index of the first element. All elements are initialized to the specified
value.</p>

<p class=MsoBodyText2>In parallel to these constructors, the classes provide
overloaded Initialize methods with the same parameters that allow initializing
of the objects after their creation. This is especially useful when using C++
classes to build the tree. See the following sections for more details.<o:p></o:p></p>

<h1><a name=IV. id=IV.>IV. Usage</a></h1>

<p class=MsoBodyText2>There are two basic ways of building the parameter tree using
the TreeParameter and TreeVariable classes. One involves the use of classic
C-language <span class=code1><span style='font-family:Courier;letter-spacing:
0pt'>struct</span></span> structures, and the other takes advantage of C++
classes. The second method has clear advantages over the first, therefore this
is the recommended one. In both cases two files need to be generated: a header
file (.h) containing the declaration of the objects, and a compile file (.cpp)
containing the definition or instantiation of the same objects. In both cases
it is also recommended to first draw a diagram of the tree similar to the one
shown in the figure of <a href="#I.">section I</a>, before starting to write
any code.<o:p></o:p></p>

<h2><a name=IV.a. id=IV.a.>a. Defining the tree using classic structures</a></h2>

<p class=MsoBodyText2>Working from the bottom up, the declaration of the tree
can start with structures containing only TreeParameters and TreeVariables,
followed by higher level structures containing the lower level ones. For
example, the partial tree illustrated in <a href="#I.">section I</a> could be
declared as follows in a header file:</p>

<p class=code><span class=code1><span style='letter-spacing:0pt'>struct
ionchamber {</span></span></p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'><span class=code1><span
style='letter-spacing:0pt'>CtreeParameterArray&amp; de;</span></span></p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'><span class=code1><span
style='letter-spacing:0pt'>CtreeParameter&amp; sum;</span></span></p>

<p class=code><span class=code1><span style='letter-spacing:0pt'>};</span></span></p>

<p class=code><span class=code1><span style='letter-spacing:0pt'>struct
focalplane {</span></span></p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'><span class=code1><span
style='letter-spacing:0pt'>struct ionchamber ic;</span></span></p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'><span class=code1><span
style='letter-spacing:0pt'>CtreeParameter&amp; other;</span></span></p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'><span class=code1><span
style='letter-spacing:0pt'>&#8230;</span></span></p>

<p class=code><span class=code1><span style='letter-spacing:0pt'>};</span></span></p>

<p class=code><span class=code1><span style='letter-spacing:0pt'>struct
spectrograph {</span></span></p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'><span class=code1><span
style='letter-spacing:0pt'>struct focalplane fp;</span></span></p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'><span class=code1><span
style='letter-spacing:0pt'>struct target ta;</span></span></p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'><span class=code1><span
style='letter-spacing:0pt'>&#8230;</span></span></p>

<p class=code><span class=code1><span style='letter-spacing:0pt'>};</span></span></p>

<p class=MsoBodyText2>Notice the use of the CTreeParameterArray class derived
from the CTreeParameter class used to declare and build a one-dimensional array
of parameters. An equivalent class CTreeVariableArray is derived from the
CTreeVariable class (see <a href="#III.">section III</a>).</p>

<p class=MsoBodyText2>The compile file performing the actual instantiation of
the tree would be required to follow the same structure:</p>

<p class=code><span class=code1><span style='letter-spacing:0pt'>struct
spectrograph s800 = </span></span></p>

<p class=code><span class=code1><span style='letter-spacing:0pt'>{</span></span></p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'><span class=code1><span
style='letter-spacing:0pt'>{</span></span></p>

<p class=code style='margin-top:0in;margin-right:1.0in;margin-bottom:0in;
margin-left:1.0in;margin-bottom:.0001pt'><span class=code1><span
style='letter-spacing:0pt'>{</span></span></p>

<p class=code style='margin-top:0in;margin-right:1.5in;margin-bottom:0in;
margin-left:1.5in;margin-bottom:.0001pt'><span class=code1><span
style='letter-spacing:0pt'>*(new CTreeParameterArray(&#8220;s800.fp.ic.de&#8221;, 4096, 0,
4095, &#8220;channel&#8221;, 16, 1)),</span></span></p>

<p class=code style='margin-top:0in;margin-right:1.5in;margin-bottom:0in;
margin-left:1.5in;margin-bottom:.0001pt'><span class=code1><span
style='letter-spacing:0pt'>*(new CTreeParameter(&#8220;s800.fp.ic.sum&#8221;, 1000, 0, 999,
&#8220;MeV&#8221;))</span></span></p>

<p class=code style='margin-top:0in;margin-right:1.0in;margin-bottom:0in;
margin-left:1.0in;margin-bottom:.0001pt'><span class=code1><span
style='letter-spacing:0pt'>},</span></span></p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'><span class=code1><span
style='letter-spacing:0pt'>*(new CTreeParameter(&#8220;s800.fp.other&#8221;, &#8220;someunit&#8221;)),</span></span></p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'><span class=code1><span
style='letter-spacing:0pt'>&#8230;</span></span></p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'><span class=code1><span
style='letter-spacing:0pt'>},</span></span></p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'><span class=code1><span
style='letter-spacing:0pt'>{</span></span></p>

<p class=code style='margin-top:0in;margin-right:1.0in;margin-bottom:0in;
margin-left:1.0in;margin-bottom:.0001pt'>definition following the struct
target&#8230;</p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'><span class=code1><span
style='letter-spacing:0pt'>},</span></span></p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'><span class=code1><span
style='letter-spacing:0pt'>&#8230;</span></span></p>

<p class=code><span class=code1><span style='letter-spacing:0pt'>};</span></span></p>

<p class=MsoBodyText2>Notice the absence of comma after the last item of a
given structure. It is very important that the Tcl name given as first
parameter of the constructors match the C++ name used in the code. Although
this method of building the tree works, it has several shortcomings. Any
modification of the tree declaration requires a modification of the
instantiation that can quickly become a headache for a large tree, especially
when changing the level of structures. In addition, the C++ code using this
tree will need to refer to each parameter by its full name, which can become
rather long as the tree grows.&nbsp;&nbsp;&nbsp; The use of references and
*(new &#8230;) avoids some nasty issues involving object registration, construction
and destruction of temporaries.</p>

<p class=MsoBodyText2>The use of C++ classes allows a much simpler and neater
implementation of this kind of tree, in particular by adding methods that can
be specialized to a particular branch.<o:p></o:p></p>

<h2><a name=IV.b. id=IV.b.>b. Defining the tree using C++ classes</a></h2>

<p class=MsoBodyText2>Following the same example as illustrated in the previous
section, the creation of the tree using C++ classes first involves declarations
in the header file:</p>

<p class=code><span class=code1><span style='letter-spacing:0pt'>extern
spectrograph s800;</span></span></p>

<p class=code><span class=code1><span style='letter-spacing:0pt'>class
ionchamber</span></span></p>

<p class=code><span class=code1><span style='letter-spacing:0pt'>{</span></span></p>

<p class=code><span class=code1><span style='letter-spacing:0pt'>private:</span></span></p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'><span class=code1><span
style='letter-spacing:0pt'>spectrograph* top;</span></span></p>

<p class=code><span class=code1><span style='letter-spacing:0pt'>public:</span></span></p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'><span class=code1><span
style='letter-spacing:0pt'>CTreeParameterArray de;</span></span></p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'><span class=code1><span
style='letter-spacing:0pt'>CTreeParameter sum;</span></span></p>

<p class=code><span class=code1><span style='letter-spacing:0pt'>public:</span></span></p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'><span class=code1><span
style='letter-spacing:0pt'>void Initialize(spectrograph* top, string name);</span></span></p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'><span class=code1><span
style='letter-spacing:0pt'>void Reset();</span></span></p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'><span class=code1><span
style='letter-spacing:0pt'>void SomeOtherMethod();</span></span></p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'><span class=code1><span
style='letter-spacing:0pt'>&#8230;</span></span></p>

<p class=code><span class=code1><span style='letter-spacing:0pt'>};</span></span></p>

<p class=code><span class=code1><span style='letter-spacing:0pt'>class
focalplane</span></span></p>

<p class=code><span class=code1><span style='letter-spacing:0pt'>{</span></span></p>

<p class=code><span class=code1><span style='letter-spacing:0pt'>private:</span></span></p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'><span class=code1><span
style='letter-spacing:0pt'>spectrograph* top;</span></span></p>

<p class=code><span class=code1><span style='letter-spacing:0pt'>public:</span></span></p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'><span class=code1><span
style='letter-spacing:0pt'>ionchamber ic;</span></span></p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'><span class=code1><span
style='letter-spacing:0pt'>CTreeParameter other;</span></span></p>

<p class=code><span class=code1><span style='letter-spacing:0pt'>public:</span></span></p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'><span class=code1><span
style='letter-spacing:0pt'>void Initialize(spectrograph* top, string name);</span></span></p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'><span class=code1><span
style='letter-spacing:0pt'>void Reset();</span></span></p>

<p class=code><span class=code1><span style='letter-spacing:0pt'>};</span></span></p>

<p class=code><span class=code1><span style='letter-spacing:0pt'>class
spectrograph</span></span></p>

<p class=code><span class=code1><span style='letter-spacing:0pt'>{</span></span></p>

<p class=code><span class=code1><span style='letter-spacing:0pt'>public:</span></span></p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'><span class=code1><span
style='letter-spacing:0pt'>focalplane fp;</span></span></p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'><span class=code1><span
style='letter-spacing:0pt'>target ta;</span></span></p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'><span class=code1><span
style='letter-spacing:0pt'>&#8230;</span></span></p>

<p class=code><span class=code1><span style='letter-spacing:0pt'>public:</span></span></p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'><span class=code1><span
style='letter-spacing:0pt'>spectrograph(string name)</span></span></p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'><span class=code1><span
style='letter-spacing:0pt'>void Reset();</span></span></p>

<p class=code><span class=code1><span style='letter-spacing:0pt'>};</span></span></p>

<p class=MsoBodyText2>The TreeParameters and branches of the tree need to be
declared as public in order to be accessible anywhere in the C++ code. The
private pointer <span class=code1><span style='font-family:Courier;letter-spacing:
0pt'>top</span></span> is used to point to the top of the tree, to access
branches that are not sub-branches of the class. The <span class=code1><span
style='font-family:Courier;letter-spacing:0pt'>extern</span></span> declaration
at the beginning of the file is needed to refer to the top class of the tree.
The name of the object is unimportant. Each class can have any number of
specialized methods for unpacking, calibrating, calculating and so on. The two
methods illustrated in this example are used to initialize the whole tree after
being constructed, and reset all parameters after each event. </p>

<p class=MsoBodyText2>The only constructor that needs to be implemented is the
top of the tree. This is preferably done in a compile file as follows:</p>

<p class=code>spectrograph::spectrograph(string name)</p>

<p class=code>{</p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'>fp.Initialize(this, name+&#8221;.fp&#8221;);</p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'>ta.Initialize(this, name+&#8221;.ta&#8221;);</p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'>&#8230;</p>

<p class=code>}</p>

<p class=MsoBodyText2>Note the use of the special pointer <span class=code1><span
style='font-family:Courier;letter-spacing:0pt'>this</span></span> to pass the
address of the top of the tree to other classes. Also notice the way the name
of the tree is propagated from top to branches using strings. This method is
much more elegant and less prone to errors than when the whole branch name
needs to be spelled out. The actual instantiation of the tree then simply looks
like:</p>

<p class=code>spectrograph s800(&#8220;s800&#8221;);</p>

<p class=MsoBodyText2>The same propagation method is used to reset the whole
tree between each event, using the <span class=code1><span style='font-family:
Courier;letter-spacing:0pt'>Reset</span></span> method:</p>

<p class=code>void spectrograph::Reset()</p>

<p class=code>{</p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'>fp.Reset();</p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'>ta.Reset();</p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'>&#8230;</p>

<p class=code>}</p>

<p class=MsoBodyText2>Therefore, simply calling the tree top method resets the
whole tree:</p>

<p class=code>s800.Reset();</p>

<p class=MsoBodyText2>The other classes in our small example are implemented as
follows:</p>

<p class=code>focalplane::Initialize(spectrograph* treetop, string name)</p>

<p class=code>{</p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'>top = treetop;</p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'>ic.Initialize(top, name+&#8221;.ic&#8221;);</p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'>other.Initialize(name+&#8221;.other&#8221;,
&#8220;someunit&#8221;);</p>

<p class=code>}</p>

<p class=code>&nbsp;</p>

<p class=code>focalplane::Reset()</p>

<p class=code>{</p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'>ic.Reset();</p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'>other.Reset();</p>

<p class=code>}</p>

<p class=code>&nbsp;</p>

<p class=code>ionchamber::Initialize(spectrograph* treetop, string name)</p>

<p class=code>{</p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'>top = treetop;</p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'>de.Initialize(name+&#8221;.de&#8221;, 4096, 0,
4095, &#8220;channel&#8221;, 16, 1);</p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'>sum.Initialize(name+&#8221;.sum&#8221;, 1000, 0,
999, &#8220;MeV&#8221;);</p>

<p class=code>}</p>

<p class=code>&nbsp;</p>

<p class=code>ionchamber::Reset()</p>

<p class=code>{</p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'>de.Reset();</p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'>sum.Reset();</p>

<p class=code>}</p>

<p class=MsoBodyText2>A tree built from C++ classes is therefore much easier
and quicker to maintain than a tree built with C structures. It also allows
more flexibility for implementing specialized functionalities that can be
embedded in the classes themselves. Finally, it makes the code much more
readable for other people than the writer.<o:p></o:p></p>

<h2><a name=IV.c. id=IV.c.>c. Handling of arrays of classes</a></h2>

<p class=MsoBodyText2>In case arrays of classes need to be built, the name of
the corresponding branches need to be prepared accordingly in the Initialize
method. Suppose for example that the following tree is declared:</p>

<p class=code>class hodoscope</p>

<p class=code>{</p>

<p class=code>public:</p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'>const int barNumber = 30;</p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'>scintillator bar[barNumber];</p>

<p class=code>public:</p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'>hodoscope(string name);</p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'>Reset();</p>

<p class=code>}</p>

<p class=code>&nbsp;</p>

<p class=code>class scintillator {</p>

<p class=code>private:</p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'>hodoscope* top;</p>

<p class=code>public:</p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'>CTreeParameter left;</p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'>CTreeParameter right;</p>

<p class=code>public:</p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'>Initialize(hodoscope* top, string
name);</p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'>Reset();</p>

<p class=code>}</p>

<p class=MsoBodyText2>Since this tree contains an array of classes of type
scintillator, the proper implementation needs to contain a loop to initialize
each element of the array:</p>

<p class=code>hodoscope::hodoscope(string name)</p>

<p class=code>{</p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'>char str[80];</p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'>for (int i=0; i&lt;barNumber; i++) {</p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'>sprintf(str, &#8220;.bar%.2d&#8221;, i);</p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'>bar[i].Initialize(this, name+str);</p>

<p class=code>}</p>

<p class=MsoBodyText2>a local character array is used to build the names of the
element arrays. In this particular example, the elements are referred to as <span
class=code1><span style='font-family:Courier;letter-spacing:0pt'>hod.bar[i]</span></span>
in the C++ code and <span class=code1><span style='font-family:Courier;
letter-spacing:0pt'>hod.barxx</span></span> in the Tcl interpreter where <span
class=code1><span style='font-family:Courier;letter-spacing:0pt'>xx</span></span>
are two digits corresponding to the element index.<o:p></o:p></p>

<h1><a name=V. id=V.>V. Implementation</a></h1>

<p class=MsoBodyText2>The TreeParameter/TreeVariable package written by Daniel
Bazin has been completely integrated with standard SpecTcl.<span
style="mso-spacerun: yes">&nbsp; </span>As a result of this integration,
many<span style="mso-spacerun: yes">&nbsp; </span>things that used to be
necessary to use TreeParameters are no longer needed.<span style="mso-spacerun:
yes">&nbsp; </span><o:p></o:p></p>

<h2><a name=V.a. id=V.a.>a. Include files</a></h2>

<p class=MsoBodyText2><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoBodyText2>A master include file includes all of the class
definitions required for your use of TreeParameter and TreeVariables.<span
style="mso-spacerun: yes">&nbsp; </span>To use these classes in your program,
each program unit that needs to know the structure of these classes must:</p>

<p class=MsoBodyText2><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=code>#include &lt;TreeParameter.h&gt;</p>

<h2><a name=V.b.>b. Additions to the main program</a></h2>

<p class=MsoBodyText2>If you are converting older uses of TreeParameter to
SpecTcl 3.0 and higher, you may get multiply defined references when you link
your software.<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>If you do,
hunt for an remove the defnintions below, as they are no longer required:</p>

<p class=MsoBodyText2><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=code>CEvent* CTreeParameter::pEvent = NULL;</p>

<p class=code>vector&lt;CTreeParameter*&gt; CTreeParameter::pSelf;</p>

<p class=code>vector&lt;CTreeVariable*&gt; CTreeVariable::pSelf;</p>

<p class=MsoBodyText2><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoBodyText2>The TreeParameters are bound to the SpecTcl parameters
only after SpecTcl has been started. This in effect creates SpecTcl parameters
and binds them to their respective TreeParameters. Prior to SpecTcl 3.0, this
action was done in the method CreateAnalysisPipeline, after all EventProcessors
have been registered.<span style="mso-spacerun: yes">&nbsp; </span>Now this is
done within SpecTcl proper.<span style="mso-spacerun: yes">&nbsp; </span>If you
are migrating TreeParameter code to SpecTcl 3.0 or later, you should remove the
line in red below from your copy of MySpecTclApp.cpp:</p>

<p class=code>void </p>

<p class=code>CSpecTclApp::CreateAnalysisPipeline(CAnalyzer&amp; rAnalyzer)</p>

<p class=code>{ </p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'>RegisterEventProcessor(someEventProcessor);</p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'>&#8230;</p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'><span style='color:red'>CTreeParameter::BindParameters(rAnalyzer);<o:p></o:p></span></p>

<p class=code>} </p>

<p class=MsoBodyText2>The TreeVariables similarly need to be linked to Tcl
variables. This is done in the method BindTCLVariables, which, prior to version
3.0 you had to modify to add a call to
CTreeVariable::BindVariables(rInterp).<span style="mso-spacerun: yes">&nbsp;
</span>This is now done by SpecTcl for you.<span style="mso-spacerun:
yes">&nbsp; </span>You should remove the line in red below if you are migrating
old code to version 3.0 and higher:</p>

<p class=code>void </p>

<p class=code>CSpecTclApp::BindTCLVariables(CTCLInterpreter&amp; rInterp)</p>

<p class=code>{ </p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'>CTclGrammerApp::BindTCLVariables(rInterp);</p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'><span style='color:red'>CTreeVariable::BindVariables(rInterp);<o:p></o:p></span></p>

<p class=code>} </p>

<p class=MsoBodyText2>Finally, the Tcl GUI taking advantage of the tree
structure of the parameters needs a few Tcl commands to operate. Prior to
version 3.0, these were <span style="mso-spacerun:
yes">&nbsp;</span>implemented in the AddCommands method.<span
style="mso-spacerun: yes">&nbsp; </span>They are now implemented in SpecTcl&#8217;s
base code and you may remove the lines in red below if you are migrating code
from older versions of SpecTcl.</p>

<p class=code>void </p>

<p class=code>CSpecTclApp::AddCommands(CTCLInterpreter&amp; rInterp)</p>

<p class=code>{ </p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'>CTclGrammerApp::AddCommands(rInterp);</p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'><span style='color:red'>CTreeVariableCommand*
m_treevariable;<o:p></o:p></span></p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'><span style='color:red'>m_treevariable
= new CTreeVariableCommand(&amp;rInterp);<o:p></o:p></span></p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'><span style='color:red'>m_treevariable-&gt;Register();<o:p></o:p></span></p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'><span style='color:red'>CTreeParameterCommand*
m_treeparameter;<o:p></o:p></span></p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'><span style='color:red'>m_treeparameter
= new CTreeParameterCommand(&amp;rInterp);<o:p></o:p></span></p>

<p class=code style='margin-top:0in;margin-right:.5in;margin-bottom:0in;
margin-left:.5in;margin-bottom:.0001pt'><span style='color:red'>m_treeparameter-&gt;Register();<o:p></o:p></span></p>

<p class=code>}<o:p></o:p></p>

<h2><a name=V.c. id=V.c.>c. Addition to the first event processor</a></h2>

<p class=MsoBodyText2>The TreeParameter class needs a pointer to the internal
SpecTcl parameter array.<span style="mso-spacerun: yes">&nbsp; </span>prior to
version 3.0 of SpecTcl, you had to add the following line to your the first event
processor. </p>

<p class=code>CTreeParameter::setEvent(rEvent);</p>

<p class=code><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoBodyText2>This is now done by SpecTcl&#8217;s code.<span
style="mso-spacerun: yes">&nbsp; </span>You may remove the line above from any
event processors you use.<o:p></o:p></p>

<h1><a name=VI. id=VI.>VI. GUI features</a></h1>

<p class=MsoBodyText2>One of the main motivations for implementing parameters
as a tree structure is the possibility to order a large number of them in a
logical manner. The Tcl/Tk framework from which SpecTcl is built offers great
opportunities to use Graphical User Interfaces (GUI) for manipulating and using
parameters arranged in such a structure. This is the goal of the SpecTcl GUI
associated with the TreeParameter and TreeVariable objects. The standared
SpecTclRC.tcl in the SpecTcl 3.0 and later Skeleton
($SpecTclHome/Skel/SpecTclRC.tcl) will start this GUI.<span
style="mso-spacerun: yes">&nbsp; </span>If you are migrating from older
versions of SpecTcl to 3.0 and later, you should modify<span
style="mso-spacerun: yes">&nbsp; </span>your SpecTcl startup scripts so that
the line below:</p>

<p class=code><span style='font-family:"Trebuchet MS"'>source
$SpecTclHome/contrib/treeparam/SpecTclGUI.tcl<o:p></o:p></span></p>

<p class=code><span style='font-family:"Trebuchet MS"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoBodyText2>Reads:</p>

<p class=code><span style='font-family:"Trebuchet MS"'>source
$SpecTclHome/Script/SpecTclGUI.tcl<o:p></o:p></span></p>

<p class=code><span style='font-family:"Trebuchet MS"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p align=center style='text-align:center'><img border=0 width=838 height=736
id="_x0000_i1026" src="TreeParameter_files\image003.jpg" alt="Text Box:  "></p>

<p class=MsoBodyText2>Upon issuing this command, the window pictured below
appears. The default page is the Spectra page where the creation and
manipulation of spectra is performed. Other pages are manipulating Parameters,
Variables and Gates as indicated by the tabs.<o:p></o:p></p>

<h2><a name=VI.a. id=VI.a.>a. Spectra manipulation page</a></h2>

<p class=MsoBodyText2>The Spectra page allows the user to create, replace,
modify, clear, duplicate and delete spectra in a convenient way. The typical
sequence for creating a new spectrum is the following:</p>

<p class=MsoNormal style='text-align:justify;text-indent:-.25in;line-height:
15.0pt'><span style='font-size:14.0pt'>Select spectrum type (red outline)</span><span
style='font-size:14.0pt;mso-bidi-font-family:Times'><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;text-indent:-.25in;line-height:
15.0pt'><span style='font-size:14.0pt'>Select data type (blue outline)</span><span
style='font-size:14.0pt;mso-bidi-font-family:Times'><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;text-indent:-.25in;line-height:
15.0pt'><span style='font-size:14.0pt'>Select parameter using the tree menu
built from the parameter tree</span><span style='font-size:14.0pt;mso-bidi-font-family:
Times'><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;text-indent:-.25in;line-height:
15.0pt'><span style='font-size:14.0pt'>Enter a spectrum name</span><span
style='font-size:14.0pt;mso-bidi-font-family:Times'><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;text-indent:-.25in;line-height:
15.0pt'><span style='font-size:14.0pt'>Click Create/Replace to perform the
action</span><span style='font-size:14.0pt;mso-bidi-font-family:Times'><o:p></o:p></span></p>

<p align=center style='text-align:center'><img border=0 width=366 height=47
id="_x0000_i1027" src="TreeParameter_files\image005.png" alt="Text Box:  "></p>

<p class=MsoBodyText2>Once a parameter has been selected, the default values of
the lower and higher limits, the number of bins of the future spectrum as well
as the unit are shown as illustrated below. The lower limit, higher limit and
number of bins can be edited before the spectrum is created. The name of the
parameter can be accessed either through the menu or by directly typing its
name in the entry box. This latter method can be faster for parameters with
similar names. A check button located below the Create/Replace button and
labeled &#8220;Array&#8221; can be used for defining individual spectra associated with a
TreeParameter array. Note that this option is only available for 1D spectra.</p>

<p align=center style='text-align:center'><img border=0 width=736 height=430
id="_x0000_i1028" src="TreeParameter_files\image007.png" alt="Text Box:  "></p>

<p class=MsoBodyText2>The lower part of the spectrum manipulation page contains
a scrollable list of defined spectra (see figure below). The columns are
successively: name, type, x parameter, low, high limits and number of bins for
x parameter, same for y parameter and finally gate condition if it exists. Each
column is resizable and the list can be sorted alphanumerically according to
any column by clicking on its name. By default the spectra are sorted by name.</p>

<p class=MsoBodyText2>Double clicking on any spectrum in the list automatically
fills the entries above with its definitions. This is useful when deriving many
similar spectra which differ only slightly like for instance with different
gating conditions. One or more spectra can be selected in different ways for
further action: a single click selects one spectrum at a time, holding the
Shift key while clicking or dragging the mouse selects a range of adjacent
spectra, and finally holding the Control key while clicking selects sparse
spectra.</p>

<p class=MsoBodyText2>The bottom part of the window is composed of an updating button
in case some spectra are defined by other means than the GUI (script or command
line), and a spectrum mask entry allowing the user to selectively list the
spectra according to a glob type string matching. The figure shows only spectra
with names starting with the letter i. This feature is useful when a large
number of spectra are defined.</p>

<p class=MsoBodyText2>The actions that can be performed on spectra selected in
the list are the following:</p>

<p align=center style='text-align:center'><img border=0 width=309 height=57
id="_x0000_i1029" src="TreeParameter_files\image009.png" alt="Text Box:  "></p>

<p class=MsoNormal style='text-align:justify;text-indent:-.25in;line-height:
15.0pt'><span style='font-size:14.0pt'>Clear</span><span style='font-size:14.0pt;
mso-bidi-font-family:Times'><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;text-indent:-.25in;line-height:
15.0pt'><span style='font-size:14.0pt'>Delete</span><span style='font-size:
14.0pt;mso-bidi-font-family:Times'><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;text-indent:-.25in;line-height:
15.0pt'><span style='font-size:14.0pt'>Duplicate</span><span style='font-size:
14.0pt;mso-bidi-font-family:Times'><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;text-indent:-.25in;line-height:
15.0pt'><span style='font-size:14.0pt'>Apply or remove gate condition</span><span
style='font-size:14.0pt;mso-bidi-font-family:Times'><o:p></o:p></span></p>

<p class=MsoBodyText2>The check button labeled &#8220;All&#8221; bypasses the selection and
applies the action to all spectra. The gate used in the gating condition can
either be entered in the entry box or selected from a popup menu.</p>

<p align=center style='text-align:center'><img border=0 width=223 height=93
id="_x0000_i1030" src="TreeParameter_files\image011.png" alt="Text Box:  "></p>

<p class=MsoBodyText2>Finally, the upper right part of this page allows the
user to save all definitions into a definition file written in Tcl and
therefore editable. This file contains not only the spectrum definitions, but
also the gate definitions, gating conditions, as well as TreeParameter and
TreeVariable default values when they differ from their definition in the C++
code. This way the entire status of SpecTcl definitions can be restored from
that only file.</p>

<p class=MsoBodyText2>When checked, the check button labeled &#8220;Failsafe&#8221;
indicates that a definition file named failsafe.tcl will be automatically
written each time a new definition is entered. This option is enabled by
default but can be disabled is it slows down the GUI response too much. The
other check button labeled &#8220;Cumulate&#8221; controls whether all previous spectra are
erased or not before a new definition file is loaded. It is unchecked by
default.<o:p></o:p></p>

<h2><a name=VI.b. id=VI.b.>b. Parameter manipulation page</a></h2>

<p class=MsoBodyText2>The parameter manipulation page allows the used to change
the default values used in the spectrum definitions. The twenty identical rows
can be used to set the lower and higher limits as well as the unit associated
with any TreeParameter. The TreeParameter names can either be accessed through
a cascading menu or typed directly into the entry box.</p>

<p class=MsoBodyText2>When the check button labeled &#8220;Array&#8221; is selected, all
members of a TreeParameterArray have their characteristics set to the same
values as the member specified in the Name entry box. This prevents the
repetitive task of setting manually all members of parameter arrays.</p>

<p class=MsoBodyText2>After the characteristics of a parameter have been
altered, the user has the possibility to transfer these modifications to all
existing spectra defined from this parameter. This feature is useful when
rescaling the range of parameters on an interesting region without having to
redefine all the spectra that depend on that parameter. The buttons labeled
&#8220;Change Spectra&#8221; perform this action, asking for confirmation for redefining
the dependent spectra. Note that this action erases the contents of the spectra.</p>

<p align=center style='text-align:center'><img border=0 width=740 height=354
id="_x0000_i1031" src="TreeParameter_files\image013.jpg" alt="Text Box:  "><o:p></o:p></p>

<h2><a name=VI.c. id=VI.c.>c. Variable manipulation page</a></h2>

<p align=center style='text-align:center'><img border=0 width=740 height=690
id="_x0000_i1032" src="TreeParameter_files\image015.jpg" alt="Text Box:  "></p>

<p class=MsoBodyText2>The variable manipulation page is in many ways very
similar to the parameter manipulation page. The twenty identical rows give
access to any of the variable tree through either a cascading menu or an entry
box. The value as well as the unit of the variables can be set. As for the
parameter manipulation page, a check button labeled &#8220;Array&#8221; allows the user to
set an entire array to the same value. The Load and Save buttons located at the
bottom of the page can be used to load or save only the variable to a Tcl file.
Remember that the variables are also saved in the definition files, so this
variable file can be used to update for instance a new set of calibrations to a
previously written definition file. It is recommended to always save the
spectra and gate definitions together with the variable definitions in order to
avoid confusion. </p>

<p class=MsoBodyText2>The definition file also saves the configurations of the
parameter and variable manipulation pages, so that the relevant entries don&#8217;t
have to be filled each time SpecTcl is restarted.<o:p></o:p></p>

<h2><a name=VI.d. id=VI.d.>d. Gate manipulation page</a></h2>

<p align=center style='text-align:center'><img border=0 width=741 height=689
id="_x0000_i1033" src="TreeParameter_files\image017.png" alt="Text Box:  "></p>

<p class=MsoBodyText2>The purpose of the gate manipulation page is to ease the
definition of composite gates &#8211; gates that are a logical combination of
&#8220;primitive&#8221; gates. In addition, the gate GUI can be used to alter the
definition of existing gates, at least the simplest kind such as the Slice
type. The &#8220;Gate Select&#8221; button is similar to the &#8220;Gate&#8221; button in the spectrum
GUI and generates a menu of existing gates that can be entered in the gate
dependency field located below. Alternatively, the gate names can be typed
directly in the entry box, separated by space characters. A &#8220;Clear dependency&#8221;
button is provided to quickly clear the dependency field, and the popup menu
located to the right selects the type of gate to be generated. The primitive
gate types are: Slice, Contour, Band, C2Band, GammaSlice, GammaBand and
GammaContour. The composite gate types are: Not, Or and And. Please refer to
the SpecTcl documentation for a description of the various gate types and their
definition syntaxes. The name of the new gate can be typed in the entry box and
the gate generated using the &#8220;Create/Replace&#8221; button.</p>

<p class=MsoBodyText2>Similar to the spectrum GUI, the list of gates can be
sorted according to one of the columns by clicking on its title, and double
clicking on a gate automatically fills the name and gate dependency fields. All
or selected gates can be deleted using the corresponding buttons. The GUI asks
for confirmation when deleting all gates.</p>

<p class=MsoBodyText2>Finally, the updating button located below the list
should be used after gates have been defined using Xamine or other means, and a
gate mask pattern similar to the one used in the spectrum GUI allows the user
to select which gates are displayed in the list.<o:p></o:p></p>

<h1><a name=VII. id=VII.>VII. Future improvements</a></h1>

<p class=MsoBodyText2>The following is a non-exhaustive list of
changes/improvements for the future versions. More items can be added to this
wish list by sending an Email to <a href="mailto:bazin@nscl.msu.edu">fox@nscl.msu.edu</a>,
or by registering an enhancement request on <a
href="http://daqbugs.nscl.msu.edu/"><span style='mso-bidi-font-size:12.0pt'>http://daqbugs.nscl.msu.edu/</span></a>.<o:p></o:p></p>

<h2><a name=VII.a. id=VII.a.>a. Filtering GUI</a></h2>

<p class=MsoBodyText2>Version 2.1 of SpecTcl implements a new filtering
capability for reduction of large data sets. The format of the filtered data is
different from the original format, therefore a filtering unpacker has to be
added to the C++ code to take advantage of this feature. The new version of the
SpecTcl GUI will include a page to handle the filtering setup.<o:p></o:p></p>

<h2><a name=VII.b. id=VII.b.>b.</a><a name=VII.c.> Saving histograms to disk</a></h2>

<p class=MsoBodyText2>SpecTcl provides Tcl commands to write histograms to disk
using various formats. The new version of the GUI will include support for
saving all or selected spectra to a file and choose its format.<o:p></o:p></p>

<h2><a name=VII.d. id=VII.d.>d. Preserve gate condition when rescaling spectra</a></h2>

<p class=MsoBodyText2>The feature allowing to rescale all spectra dependent on
a given parameter (see Parameter manipulation, Chapter VI.b) doesn&#8217;t propagate
the gate condition. This is a bug that will be fixed.</p>

</div>

</body>

</html>
