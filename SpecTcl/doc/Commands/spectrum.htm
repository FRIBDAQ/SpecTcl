<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">

<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
<title>spectrum - SpecTcl Command</title>
</head>

<body>

<table border="0" cellpadding="0" cellspacing="0" width="100%">
    <tr>
        <th width="9%" nowrap><a href="http://www.nscl.msu.edu"><img
        src="../images/nscl_logo_small.gif"
        alt="nscl_logo_small.gif (2463 bytes)" width="63" height="52"></a></th>
        <td width="79%"><h1>spectrum - SpecTcl Command</h1>
        </td>
        <td width="12%"><a href="../index.htm"><img
        src="../images/hh00706_.jpg"
        alt="HH00706_.wmf (6530 bytes)" width="192" height="84"></a></td>
    </tr>
</table>

<p><a href="../index.htm" name="Top">SpecTcl Home</a>&nbsp; <a
href="../general_information.htm">General Information</a> <a
href="../users_guide.htm">User Guide</a> <a
href="../programmers_guide.htm">Programmer's Guide</a> <a
href="../obtaining_and_installing.htm">Obtaining and Installing</a></p>

<h2>Syntax</h2>

<p>spectrum [-new] <em>name type parameter-list axis-speclist </em>[<em>datatype</em>]<br>
spectrum -list [-byid]<br>
spectrum -list <em>name</em><br>
spectrum -list -id <em>id<br>
</em>spectrum -delete <em>name </em>[<em>name...</em>]<br>
spectrum -delete <em>id </em>[<em>id...</em>]<br>
spectrum -delete -all</p>

<h2>Synopsis</h2>

<p>Creates, lists properties of and deletes spectra.</p>

<ul>
    <li>-new will return empty string or reason that the
        histogram could not be created.</li>
    <li>-list will return the set of histograms listed (or the
        error reason if histograms could not be listed). This is
        a list containing a sublist for each spectrum. Each
        spectrum sublist contains in order the Id, the name,
        dimensionality, list of parameters, and list of
        resolutions.</li>
    <li>-delete will return either a null string or the list of
        spectra which could not be deleted. For each spectrum a
        list containing the spectrum name or id and the reason it
        could not be deleted.</li>
</ul>

<p><a href="#Top">Top</a></p>

<h2>Detailed Description</h2>

<p>SpecTcl maintains a dictionary of spectra. The size of the
parameter dictionary and the total amount of spectrum storage is
limited only by the program's virtual memory. Each spectra has
the following properties:</p>

<ul>
    <li><em>name</em> A spectrum name which can be used to refer
        to the spectrum in other operations.</li>
    <li><em>id</em> A positive integer identifier which is
        sequentially assigned to spectra as they are created. The
        id can also be used for identification purposes in most
        cases, however this is less meaningful than the name.</li>
    <li><em>type</em> - The type of spectrum to be created.
        SpecTcl supports the following spectrum types:<br>
        <div align="left"><table border="0" cellpadding="3"
        cellspacing="4">
            <tr>
                <td>1</td>
                <td>1d spectrum of a single parameter is created.</td>
            </tr>
            <tr>
                <td>2</td>
                <td>2d spectrum of two parameters is created.</td>
            </tr>
	    <tr>
	      <td>g1</td>
	      <td>1d spectrum of a list of parameters is created.</td>
	    </tr>
	    <tr>
	      <td>g2</td>
	      <td>2d spectrum of a list of at least two parameters is created.</td>
            <tr>
                <td>s</td>
                <td><a href="#Summaries">Summary 2d spectrum</a>
                is created of an arbitrary number of parameters.</td>
            </tr>
            <tr>
                <td>b</td>
                <td>Bitmask spectrum of a single parameter is
                created</td>
            </tr>
        </table>
        </div></li>
    <li><em>parameter-list</em> The set of parameters which are
        required to increment the spectra. How this is
        interpreted depends on the spectrum type. The list has
        the following composition, depending on the <em>type</em>
        parameter:<br>
        <div align="left"><table border="0" cellpadding="3"
        cellspacing="4">
            <tr>
                <td><strong>Spectrum Type</strong></td>
                <td valign="bottom"><strong>Parameter list
                contents</strong></td>
            </tr>
            <tr>
                <td>1</td>
                <td>The name of the single parameter to be
                histogrammed.</td>
            </tr>
            <tr>
                <td valign="top">2</td>
                <td>The names of the two parameters to be
                histogrammed. The first parameter is on the X
                axis, the second on the Y.</td>
            </tr>
	    <tr>
	      <td>g1</td>
	      <td>The names of the parameters to be histogrammed.</td>
	    </tr>
	    <tr>
	      <td valign="top">g2</td>
	      <td>The names of the parameters to be
		histogrammed. The first parameter is on the X
		axis, the second on the Y.</td>
            <tr>
                <td>s</td>
                <td>The set of parameters on the X axis of the
                spectrum. See<a href="#Summaries"> here</a> for
                more information.</td>
            </tr>
            <tr>
                <td>b</td>
                <td>The parameter whose bits will be decoded and
                histogrammed.</td>
            </tr>
        </table>
        </div></li>
    <li><em>resolution-list</em> The set of axis resolutions. The
        number of axis resolutions in the list must be as
        described below:<br>
        <div align="left"><table border="0" cellpadding="3"
        cellspacing="4">
            <tr>
                <td><strong>Spectrum Type</strong></td>
                <td><strong>Resolution List Contents.</strong></td>
            </tr>
            <tr>
                <td>1</td>
                <td>The single resolution of the X axis.</td>
            </tr>
            <tr>
                <td>2</td>
                <td>The X and Y axis resolutions in that order.</td>
            </tr>
	    <tr>
	      <td>g1</td>
	      <td>The single resolution of the X axis.</td>
	    </tr>
	    <tr>
	      <td>g2</td>
	      <td>The X and Y axis resolutions in that order.</td>
	    </tr>
            <tr>
                <td valign="top">s</td>
                <td>The Y axis resolution. The X axis resolution
                is determined by the number of parameters. See <a
                href="#Summaries">here</a> for more information
                about summary spectra.</td>
            </tr>
            <tr>
                <td valign="top">b</td>
                <td>The resolution of the x axis which determines
                the number of bits which are histogrammed from
                the parameter. e.g. if b = 3 then an 8 channel
                spectrum of the bottom 8 bits is created. Values
                larger than 32 are allowed, but not very sensible
                at this time.</td>
            </tr>
        </table>
        </div></li>
    <li><i>axis-speclist </i>is a list of axis specifications for each axis in
      the histogram.&nbsp; Axis specifications can either an <i>axis resolution</i>
      or an <i>axis specification</i>.&nbsp; An <i>axis resolution </i>is the
      number of bits of resolution <i>n&nbsp;</i> in the axis.&nbsp; For an axis
      resolution, the number or channels in the axis is 2**n, and the channels
      are in the range [0, 2**n).&nbsp; An <i>axis specification,&nbsp;</i> is a
      three element list {<i>low high n</i>}.&nbsp;&nbsp; The axis will contain <i>n</i>
      channels that run in the range [<i>low, high</i>].</li>
    <li><em>datatype</em> represents the type of data for each
        channel of the histogram:<br>
        <div align="left"><table border="0" cellpadding="3"
        cellspacing="4">
            <tr>
                <td>byte</td>
                <td>Each channel is 8 bits.</td>
            </tr>
            <tr>
                <td>word</td>
                <td>Each channel is 16 bits.</td>
            </tr>
            <tr>
                <td>long</td>
                <td>Each channel is 32 bits.</td>
            </tr>
        </table>
        </div></li>
</ul>

<p>Various forms of the <strong>spectrum</strong> command
manipulate, or query this parameter dictionary.</p>

<p><a href="#Top">Top</a></p>

<h3>spectrum [-new] <em>name ndim parameter-list </em><i>axis-speclist</i></h3>

<p>Creates a new spectrum. Note that the <strong>-new</strong>
switch is optional. The spectrum attributes are assigned as
follows:</p>

<ul>
    <li><em>name</em> taken from the <em>name </em>comand line
        parameter.</li>
    <li><em>datatype</em> the type of spectrum being created.</li>
    <li><em>parameter-list</em> taken from the single <em>parameter-list</em>
        parameter. This must be a properly formatted TCL/Tk list.
        Thus to specify two parameters, par1 and par2 for a 2-d
        spectrum, use the syntax: {par1 par2}. For 1-d spectra,
        the brackes are not needed.</li>
    <li><i>axis-speclist</i> is a list of axis specifications.&nbsp; Each axis
      specification is either an <i>axis resolution</i> or an <i>axis
      specification</i>.&nbsp; An <i>axis resolution </i>is the number of bits
      of resolution <i>n&nbsp;</i> in the axis.&nbsp; For an axis resolution,
      the number or channels in the axis is 2**n, and the channels are in the
      range [0, 2**n).&nbsp; An <i>axis specification,&nbsp;</i> is a three
      element list {<i>low high n</i>}.&nbsp;&nbsp; The axis will contain <i>n</i>
      channels that run in the range [<i>low, high</i>].&nbsp; For example:
</ul>

<table>
	<tr>
      <blockquote>
        <p><em>spectrum name1&nbsp; 1&nbsp; res&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        12&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        ;# 4096 channels 0-4095<br>
        spectrum name2&nbsp; 1&nbsp;
        spec&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        {-10.0 10.0 200} ;# 200 channels in the range [-10.0,10.0]<br>
        spectrum name3 2d {res spec}&nbsp;&nbsp;&nbsp;&nbsp; {12 {-10.0 10.0
        200}} ; # X is res, y is spec.</em></p>
      </blockquote>
	</tr>
</table>

<ul>
    <li><em>datatype - </em>The type of data stored in the
        histogram. <strong>Note</strong> that each spectrum has
        restrictions on types which are allowed:<br>
        <div align="left"><table border="0" cellpadding="3"
        cellspacing="4">
            <tr>
                <td>1</td>
                <td>Can be word or long</td>
            </tr>
            <tr>
                <td>2</td>
                <td>Can be byte or word</td>
            </tr>
	    <tr>
	      <td>g1</td>
	      <td>Can be word or long</td>
	    </tr>
	    <tr>
	      <td>g2</td>
	      <td>Can be byte or word</td>
	    </tr>
            <tr>
                <td>s</td>
                <td>Can be byte or word</td>
            </tr>
            <tr>
                <td>b</td>
                <td>Can be word or long</td>
            </tr>
        </table>
        </div></li>
</ul>

<p>If creation is successful, the name of the spectrum is
returned, otherwise an error message is returned.</p>

<h4><a name="Summaries">Summary Spectra</a></h4>

<p>Summary spectra are intended to be used to aid troubleshooting
of large detector systems. Summary spectra are 2-d spectra which
provide a single display of many parameters. A summary spectrum
histograms parameter values on the y axis for several parameters
on the X axis. For example, an Si strip detector could be
histogrammed to get an Energy vs. position plot. For example, in
the spectrum created by the command:</p>

<pre>spectrum Summary s {Si1 Si2 Si3 Si4} 8</pre>

<p>creates a 4 x 256 channel spectrum. Each Y strip is
histogrammed as follows: strip 0 is a histogram of Si1, Strip 1
is a histogram of Si2, strip 2 is a histogram of Si3.. .and so
forth.</p>

<p><a href="#Top">Top</a></p>

<h3>spectrum -list [-byid]</h3>

<p>Lists all spectra in the spectrum dictionary. If the optional <strong>-byid</strong>
switch is included, then the spectra are sorted by id, otherwise
they are sorted alphabetically by name. Spectra are listed in a
format which allows them to be easily manipulated by other Tcl
commands. The output is a list, where each spectrum is
represented by a sublist containing in order: The Spectrum id,
spectrum name, dimensionality, parameter list (a properly
formatted sub-sublist) axis-definition list (a properly formatted sublist).&nbsp;
In order to make processing these definitions easy, all axis definitions are
rendered in specification form {low high nchans} regardless of how they were
originally specified when the spectrum was created for example:</p>

<pre>{24 d1_0 1 {Distribution1} {{0.000000 1023.000000 1024}} long}
{19 d1bl b {Distribution1} {{0.000000 15.000000 16}} long}
{20 d1bw b {Distribution1} {{0.000000 31.000000 32}} word}
{17 d1m 1 {Distribution1} {{100.000000 200.000000 50}} long}
{22 d1sumb s {Distribution1 Distribution1 Distribution1 Distribution2 
Distribution1 Distribution1 Distribution1 Distribution1} {{0.000000 1023.000000 1024}} byte}
8 d1-vs-sum 2 {Distribution1 dist1+dist2} {
{0.000000 1023.000000 256} {0.000000 2047.000000 256}} word}</pre>

<pre><a href="#Top">Top</a></pre>

<h3>spectrum -list <em>name</em></h3>

<p>Lists the spectrum with the supplied <em>name</em>, or an
error message if <em>name</em> could not be listed.</p>

<h3>spectrum -list -id <em>id</em></h3>

<p>Lists the spectrum with the supplied <em>id</em>, or an error
message if <em>id</em> could not be listed.</p>

<h3>spectrum -delete <em>name </em>[<em>name...</em>]</h3>

<p>Deletes the spectra listed by <em>name</em>. If some spectra
cannot be deleted, then a list is returned containing the set of
spectra which could not be deleted and why e.g.</p>

<pre>{d7 {No such Spectrum}} {d9 {No such Spectrum}}</pre>

<p><a href="#Top">Top</a></p>

<h3>spectrum -delete -id <em>id </em>[<em>id...</em>]</h3>

<p>Deletes the spectra listed by id.</p>

<h2>Examples:</h2>

<pre>spectrum d3-vs-d5 2 {Distribution2 Distribution5} {8 8}   ;# Make a new 2-d spectrum.
spectrum -list -byid                                      ;# List spectra sorted by id.
spectrum mapped 2 {Distribution1 Distribution2} {{10 99 90} {50 99 100}}   ;# Make a 2d spectrum with 90*100 bins.
#
#  The following multiline example just lists only the names of spectra:
#
% set result &quot;&quot;
% foreach Spectrum [spectrum -list] {
   append result [lindex $Spectrum 1] &quot;\n&quot;
}                                            ;# result contains the list.
set $result                                 ;# Show the list
d1
d1-vs-sum
d2
d3
d3-vs-sum
d4
d5
sum
#
#  The following multiline example creates a list widget containing the set of defined
#  spectra packs it onto the default top level window and updates it every second.
#
listbox .spectra                           ;# Create the list box.
proc specupdate {} {                       ;# Procedure to update the list box by
    .spectra delete 0 [.spectra size]      ;# Deleting all elements and
    foreach spec [spectrum -list] {        ;# Filling the box with the set of defined
      .spectra insert end [lindex $spec 1] ;# spectra.
    }
    after 1000 specupdate                  ;# Reschedules itself.
}
specupdate                                 ;# This sets up the initial listbox contents.
pack .spectra                              ;# and adds the listbox to the top-level win.</pre>

<p><a href="spectrum.htm#Top">Top</a></p>

<p><a href="../index.htm" name="Top">SpecTcl Home</a>&nbsp; <a
href="../general_information.htm">General Information</a> <a
href="../users_guide.htm">User Guide</a> <a
href="../programmers_guide.htm">Programmer's Guide</a> <a
href="../obtaining_and_installing.htm">Obtaining and Installing</a></p>

<hr>

<p>Last Modified: <!--webbot bot="Timestamp" s-type="EDITED"
s-format="%B %d, %Y" startspan -->October 28, 2003<!--webbot bot="Timestamp" endspan i-checksum="30351" --> by: <a
href="mailto:fox@nscl.msu.edu">fox@nscl.msu.edu</a><br>
<font size="2">© Copyright NSCL 1999, All rights reserved</font></p>
</body>
</html>
