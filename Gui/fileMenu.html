<html>
    <head><title>The File Menu</title>
    </head>


    <body>
    <h1>The File Menu</h1><a name="top" />
    <p>The file menu provides commands that allow you to save and restore various
        pieces of SpecTcl state.  In addition, the file menu supports execution
        of arbitrary Tcl scripts as well as exiting the GUI. </p>
        <br><a href="#top">Top</a>
        <h3>Save...</h3>
            <p>The File-&gt; Save command prompts for a file to which the state of
            the SpecTcl analysis will  be written.  The state is written as a SpecTcl
            script.  This script can be sourced back in either with the File-&gt;Restore...
            command or via the File->&gt;Source Tcl Script command.</p>
            <p>The following object types, allong with code necessary to remove previously existing
               instances of each object where necessary, are written to file:</p>
            <ul>
                <li><em>TreeParameters</em> - any modified or newly created tree parameter definitions
                    are written to file.   If a treeparameter has been created dynamically, code to
                    recreated it is preceded with code to delete it if it exists.</li>
                <li><em>PseudoParameters</em> - All pseudo parameter definitions are written to file.
                    Each definition is preceded with code to delete the pseudo if it already exists
                    at the time it is being read in.</li>
                <li><em>SpectrumDefinitions</em> - All spectrum definitions are written to file along with
                    code to delete any previously existing spectrum that would duplicate the
                    new definition.</li>
                <li><em>GateDefinitions</em>  - All gate definitions are written to file.   Gate definitions
                    are written in reverse dependency order.  Since gate definition is dynamic, no code
                    is provided to delete existing gates.</li>
                <li><em>GateApplications</em> - Gate applications are written to file.  These applications reconstruct
                    the conditions on spectra that existed at the time the file was saved.</li>
                <li><em>Filters</em> - All filters definitions are written to file.  Filters definitions are
                    preceded with code that, if necessary deletes a duplicate pre-existing filter.  All
                    filters are written to be reconstructed in the disabled state.</li>
            </ul>
            <br><a href="#top">Top</a>
        <h3>Save TreeVariables...</h3>
            <p>TreeVariables provide a set of Tcl variables that are organized like a structure
               or set of structures.   TreeVariables are typically used to <em>steer</em> computations
                performed by user written event processors.  The File-&gt;Save TreeVariables... command prompts
                for a file to which only the treevariable definitions are saved.  The TreeVariables are saved
                exactly as if they had been written via the File-&gt;Save... command.</p>
            <br><br><a href="#top">Top</a>
        <h3>Save Contents of Spectra...</h3><a name="saveSpectrumContents" />
            <p>The File-&gt;Save Contents of Spectra... command displays a dialog that graphically prompts
               you for a filename and a set of spectra.  The Spectra are chosen by double clicking them from
               a browser that shows only the spectra.  Spectra chosen are transferred to a scrolling listbox.
               If you select a spectrum by mistake you may double click it within the listbox to remove it
               from the list box.  The browser will only display spectra that have not yet been chosen.</p>
            <p>If you click the Ok button on the dialog, the set of spectra you have selected will be written
               in listbox order to the file you selected.  Spectra are written using the swrite <em>-format ascii</em>
               command.   A spectrum file can be read in using the File-&gt;Read Spectrum File... command.</p>
            <br><br><a href="#top">Top</a>
        <h3>Load...</h3>
            <p>The File-&gt;Restore... command allows you to choose a saved spectrum script and
                execute it to restore the state of analysis.</p>
            <br><br><a href="#top">Top</a>
        <h3><a name="readSpectrumContents" />Read Spectrum File...</h3>
            <p>The File-&gt;Read Spectrum File... allows you to read all the spectra from a file
               saved via e.g. File-&gt;Save Contents Of Spectra...  In addition to choosing the
               file to recover you may also control the switches that the GUI will supply to the
               <em>sread</em> command by checking or unchecking the state of three checkbox controls:</p>
                <ul>
                    <li><em>Snapshot</em> - If checked, the spectrum will not be incremented by subsequent
                        events.</li>
                    <li><em>Replace existing spectra</em> - If checked, if a spectrum in the file has a name
                        that matches an existing spectrum, the existing spectrum is replaced by the
                        spectrum in the file.  If unchecked, a unique spectrum is created by appending an
                        underscore and a number to the base spectrum name.</li>
                    <li><em>Bind To Display</em> - If checked, the spectrum is bound to the display.
                    </li>
                </ul>
            <br><br><a href="#top">Top</a>
        <h3>Source Tcl Script</h3>
            <p>The File-&gt;Source Tcl Script... commmand graphically prompts for a
                Tcl or Tk scrip which is then sourced into SpecTcl.</p>
            <br><br><a href="#top">Top</a>
        <h3>Exit</h3>
            <p>The File-&gt;Exit... command allows you to exit the Gui.  You may restart the Gui
                at any time by typing:</p>
                <br><pre>startGui</pre>
            <br><br><a href="#top">Top</a>
    </body>
</html>
